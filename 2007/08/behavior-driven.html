
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>
      
        Rails and TDD/BDD - 
      
      geek!daily
    </title>
    
    <meta name="author" content="Jim Meyer">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link href="/assets/themes/hooligan/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/hooligan/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/assets/themes/hooligan/css-social-buttons/css/zocial.stripped.css">
    <link href="/assets/themes/hooligan/css/pygments.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/hooligan/css/darkstrap.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/hooligan/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- fav and touch icons -->
    <!-- Update these with your own images
      <link rel="shortcut icon" href="images/favicon.ico">
      <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
      <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
      <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    -->
  </head>

  <body>
    <div id="page-wrap">
      <div class="navbar">
        <div class="navbar-inner">
          <div class="container">
            <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>

            <a class="brand" href="/">geek!daily</a>

            <div class="nav-collapse">
              <ul class="nav">
                
                
                


  
    
      
      	
      	<li><a href="/about.html">About</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/blog.html">Blog</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/projects.html">Projects</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/specs.html">Specs</a></li>
      	
      
    
  
    
      
    
  



              </ul>
              <ul class="nav pull-right social visible-desktop">
                <li class="divider-vertical"></li>
                
                <li>
                  <a href="https://github.com/purp" class="zocial github icon" target="_blank">
                    <span class="hidden-desktop">Github</span>
                  </a>
                </li>
                
                
                
                <li>
                  <a href="https://twitter.com/purp" class="zocial twitter icon" target="_blank">
                    <span class="hidden-desktop">Twitter</span>
                  </a>
                </li>
                
                
                
                <li>
                  <a href="http://www.linkedin.com/in/jimmeyer" class="zocial linkedin icon" target="_blank">
                    <span class="hidden-desktop">LinkedIn</span>
                  </a>
                </li>
                
                
                <li>
                  <a href="http://feeds.feedburner.com/geekdailyblog" class="zocial rss icon" target="_blank">
                    <span class="hidden-desktop">FeedBurner</span>
                  </a>
                </li>
                
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="container">
        <div class="content">
          
<div class="page-header">
  <h1>
    Rails and TDD/BDD 
    
  </h1>
</div>

<div class="row">
  <div class="span8">
    <p><em>I’m going to limit this post to my notes on the excellent learnings from the day of many testing talks at Rails Edge Chicago and follow up with another post for my addle-pated musings thereupon.</em></p>

<p>First I’d like to observe that <strong>Rails benefits heavily by the fact that Railers care passionately about BDD</strong> , coverage testing, seeking complete coverage, and beautiful, elegant code. In the past month at various Rails and non-Rails conferences, I’ve heard it hammered over and over again in many ways:</p>

<ul>
  <li>You’ve got to have 100% coverage; anything less is uncertainty.</li>
  <li>It’s better to submit a test with no patch than a patch with no test.</li>
  <li>I pretty much don’t accept patches without a test.</li>
</ul>

<p>…and many more. This shared mindset results in a community of developers who not only bring an ethic of constant improvement but also who seek to make code ownership irrelevant. More on that in the Conclusions.</p>

<p><strong>Watching <a href="http://onestepback.org/">Jim Weirich</a> do BDD was a religious experience.</strong> His talk was titled, “Red, Green, Refactor” which is the concise expression of his process: make a failing test, make the test pass, then do it again. He just sat down and started making tests, then writing just enough code to satisfy the test. It was design on the fly, iteratively building up the model in small increments, testing, and again; part of my joy from this was to watch as an excellent programmer exposed his process, even to the point of incorporating feedback from the room. His rake task for testing tracks the number of times it’s been called. If his talk is to be believed, he does it like this every day. And I believe.</p>

<p>Incidentally, <strong>Jim writes monster-long test names</strong> like “test_portfolio_with_one_stock_has_value_same_as_stock_value” <strong>to make his intent instantly readable.</strong> His point is that you’re only going to type this name once, so don’t let a desire for “manageable” method names get in the way of expressive, semantic naming.</p>

<p>And he made me realize how cool flexmock is: <tt>flex_mock_obj.should_receive(:quote).times(3).and_return(4,30,100)</tt></p>

<p><strong><a href="http://relevancellc.com/">Justin Gehtland</a> and <a href="http://relevancellc.com/">Stuart Halloway</a> are awesome presenters</strong> and it’s easy to see they enjoy working together. They’re BDD practitioners and advocates of it and it was a pleasure to hear them talk.</p>

<p><strong><a href="http://blog.davidchelimsky.net/">David Chelimsky</a></strong> is the lead developer of <a href="http://rspec.rubyforge.org/">RSpec</a>, a very thoughtful person (as in “he thinks often and well”, though I’m sure he’s also kind =), and a vicious Werewolf waiting to happen. He did a half-hour speed talk about RSpec, which I’d only just heard about three weeks ago when talking to <a href="http://eastmedia.com/">Matt Pelletier</a> and again a couple of weeks ago at <a href="http://rubyhoedown2007.confreaks.com/session01.html">Ruby Hoedown</a>. The general idea is you define your spec in a domain-specific language (DSL) which can then be executed to demonstrate that you meet spec. This was already on my list, but David’s moved it up quite a lot. He left me with some research:</p>

<ul>
  <li><a href="http://dannorth.net/2007/06/introducing-rbehave"><strong>RBehave</strong></a>: story level behavior testing</li>
  <li><a href="http://blog.labnotes.org/2006/09/04/assert_select-cheat-sheet/"><strong>assert_select</strong></a>: find CSS items in page and assert about them.</li>
  <li><strong><a href="http://dev.thefrontside.net/crosscheck/wiki/Overview">CrossCheck</a></strong> : java tool that emulates popular browsers to test your Javascript “in browser”</li>
  <li><strong><a href="http://www.zenspider.com/ZSS/Products/ZenTest/">ZenTest/AutoTest</a></strong> : test like mad</li>
  <li><strong><a href="http://blog.codefront.net/2007/04/01/get-your-testing-results-via-growl-notifications/">Test Notifications via Growl</a></strong> : combined with AutoTest, you can just watch things start working as you fix tests. Cool!</li>
</ul>

<p>He also gave me reading: <strong><a href="http://domaindrivendesign.org/">Domain Driven Design</a></strong> , by Eric Evans.</p>

<p><strong><a href="http://www.elevatedrails.com/">Mike Mangino</a>’s</strong> talk, “Testing for the Real World”, made some excellent points:</p>

<ol>
  <li>Fast tests get run.</li>
  <li>Slow tests don’t.</li>
  <li>The only tests that help are the ones that get run.</li>
</ol>

<p>Actually, <strong>his talk seemed like a barrage of excellent points</strong> in retrospect; I ended up with a bunch of concise snippets in my notes which I’ll try to reconstitute into full explanations here. Apologies to Mike if I screw it up and libel his abilities; you should assume any errors are in my understanding or ability to explain the concept.</p>

<p><strong>Fixtures don’t scale well for large quantities of data,</strong> so if you’re testing against a lot of data you’re best not using them. However, they’re alway useful as templates for test objects; for example, if you’re going to do a bunch of tests which all use the same data with only slight variations (testing each of many validators, &amp;c) it can be handy to get the original object from a fixture and tweak it to suit your test.</p>

<p>Mocking can reveal the ugly spots when testing a controller. For example, if you find you need to mock a phonebook object to return an entry, an entry object to return a name, and a name object to return a last name … you’ve got issues in the code. In fact, it’s a good generalization that <strong>hard-to-test code very likely needs refactoring</strong>.</p>

<p>Meanwhile, it’s much easier to generate tests for views and controllers if you do them separately. Particularly, Mike recommends mocking helpers in view tests and testing the helpers separately.</p>

<p>Mike finally said the right words to make the difference between stubbing and mocking stick for me (yeah, I may be dumb but I’m slow). <strong>If the return value is important to the bit you’re testing, mock it; otherwise, stub it.</strong> He also mentioned that filters are hard to stub, but I didn’t catch an explanation so I’ll have to learn why on my own.</p>

<p>One of the best snippets: <strong>Tests should be informative first, DRY second</strong>. You want people who read your tests to instantly get it, not have to slog through various helper functions to figure out what’s going on.</p>

<p>Oh, and more research: <a href="http://cruisecontrol.sourceforge.net/">CruiseControl</a>, a continuous build/integration tool based on the work of <a href="http://www.martinfowler.com">Martin Fowler</a> and <a href="http://blog.foemmel.com/">Matthew Foemmel.</a> When I tried to have a look at the <a href="http://cruisecontrolrb.thoughtworks.com/">Ruby/Rails version</a> is seemed the server was not responding.</p>

<p>Hey, Technorati! Get this: <a href="http://technorati.com/tag/therailsedge">therailsedge</a> <a href="http://technorati.com/tag/railsedge">railsedge</a> <a href="http://technorati.com/tag/railsedge2007">railsedge2007</a></p>


    <hr>
    <div class="pagination btn-group">
      
        <a class="btn prev" href="/2007/08/mits-clutter-de.html" title="MIT's 'clutter detector' could cut confusion - MIT News Office">&larr; Previous</a>
      
        <a class="btn" href="/archive.html">Archive</a>
      
        <a class="btn next" href="/2007/08/context-aware-i.html" title="Context Aware Image Re-Sizing">Next &rarr;</a>
      
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    

    var disqus_shortname = 'geekdaily'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
  
  <div class="span4">
    <section>
      <h4>Published</h4>
      <div class="date"><span>24 August 2007</span></div>
      
    </section>
    
      <section>
        <h4>Categories</h4>
        
        <span class="category">
          ruby/rails
        </span>
        
        <span class="category">
          testing
        </span>
        
      </section>
         
             
  </div>
</div>


        </div>
      </div> <!-- /container -->

      <div class="footer-push"></div>
    </div><!--/.page-wrap -->

    <footer>
      <div class="container">
        <p>&copy; 2017 Jim Meyer
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://github.com/dhulihan/hooligan" target="_blank">The Hooligan Theme</a>
        </p>
      </div>
    </footer>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/assets/themes/hooligan/js/jquery.min.js"><\/script>')</script>
    <script src="/assets/themes/hooligan/bootstrap/js/bootstrap.min.js"></script>

    




  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-225723-36']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>

