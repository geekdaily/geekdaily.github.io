
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>
      
        LiveBlog: 10+ Deploys A Day: Dev and Ops at Flickr - 
      
      geek!daily
    </title>
    
    <meta name="author" content="Jim Meyer">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link href="/assets/themes/hooligan/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/hooligan/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/assets/themes/hooligan/css-social-buttons/css/zocial.stripped.css">
    <link href="/assets/themes/hooligan/css/pygments.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/hooligan/css/darkstrap.css" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/hooligan/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- fav and touch icons -->
    <!-- Update these with your own images
      <link rel="shortcut icon" href="images/favicon.ico">
      <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
      <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
      <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    -->
  </head>

  <body>
    <div id="page-wrap">
      <div class="navbar">
        <div class="navbar-inner">
          <div class="container">
            <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>

            <a class="brand" href="/">geek!daily</a>

            <div class="nav-collapse">
              <ul class="nav">
                
                
                


  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



              </ul>
              <ul class="nav pull-right social visible-desktop">
                <li class="divider-vertical"></li>
                
                <li>
                  <a href="https://github.com/purp" class="zocial github icon" target="_blank">
                    <span class="hidden-desktop">Github</span>
                  </a>
                </li>
                
                
                
                <li>
                  <a href="https://twitter.com/purp" class="zocial twitter icon" target="_blank">
                    <span class="hidden-desktop">Twitter</span>
                  </a>
                </li>
                
                
                
                <li>
                  <a href="http://www.linkedin.com/in/jimmeyer" class="zocial linkedin icon" target="_blank">
                    <span class="hidden-desktop">LinkedIn</span>
                  </a>
                </li>
                
                
                <li>
                  <a href="http://feeds.feedburner.com/geekdailyblog" class="zocial rss icon" target="_blank">
                    <span class="hidden-desktop">FeedBurner</span>
                  </a>
                </li>
                
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="container">
        <div class="content">
          
<div class="page-header">
  <h1>
    LiveBlog: 10+ Deploys A Day: Dev and Ops at Flickr 
    
  </h1>
</div>

<div class="row">
  <div class="span8">
    <p>Update 1: <a href="http://www.slideshare.net/jallspaw/10-deploys-per-day-dev-and-ops-cooperation-at-flickr">Slides are now on SlideShare.</a></p>

<p>Update 2: <a href="http://velocityconference.blip.tv/file/2284377">Video now available on blip.tv</a></p>

<p>John Allspaw (Ops) &amp; Paul Hammond (Eng), Twitter</p>

<p>“Actually work together and aren’t huge assholes to each other.”</p>

<p>(omitted: photo stats … that’s a lot of kittens)</p>

<p>Dev vs. Ops</p>

<ul>
  <li>It’s not my {machines,code} it’s your {code,machines}</li>
</ul>

<p>Spock v. Scottie analogy</p>

<p>Ops as grumpy old man, says no all the time, cycle of “no all the time because no one tells them anything because they say no all the time”</p>

<p>CW: dev job to add features, ops job to keep site stable and fast</p>

<p>Flickr: Ops job is to enable the business (Dev’s, too)</p>

<p>Business requires change, otherwise you’ll be overtaken by the new guy … but change is the root cause of most outages.</p>

<p>Discourage change vs. Allow it to happen as often as it needs to (via tools and culture)</p>

<p>Lowering the risk of change via tools and culture.</p>

<ul>
  <li>Increase confidence in change goodness</li>
  <li>Increase ability to react to those changes</li>
</ul>

<p>You need {ops,devs} who think like {dev,ops}</p>

<ol>
  <li>
    <p>Role and Config Mgmt</p>
  </li>
  <li>
    <p>Shared Version Control: everyone looks in the same place for everything</p>
  </li>
</ol>

<ul>
  <li>Code and config in same place</li>
  <li>Everyone has access—transparency</li>
  <li>Everyone knows how to use it</li>
</ul>

<p>3a. One-step build</p>

<ul>
  <li>Everything you need to do to convert svn co’d code into what goes to the site—one command</li>
  <li>They have “Perform Staging” button at bottom of a page with stats on latest commit</li>
</ul>

<p>3b. One-step deploy</p>

<ul>
  <li>Top of page is deploy log with notes: who, when, what (link to changes)</li>
  <li>Bottom has “I’m feeling lucky!” button to deploy</li>
  <li>Continuous deployment</li>
</ul>

<p>You can’t pretend to deploy 10 times a day if you go down 10 times a day. That’s not being agile, that’s being retarded.</p>

<p>They use Hudson to generate packages which can be deployed by ops</p>

<p>Small frequent changes make it easier to see what went wrong and recover when needed</p>

<ol>
  <li>[missed that tag]</li>
</ol>

<ul>
  <li>Branching is all about managing bugfixes</li>
  <li>Always ship trunk</li>
  <li>Branch in code instead: use conditionals to block out pre-release features and configure off/invis—provides an operational lever for adjustment</li>
  <li>Makes these open for private beta in production on production hdwe, etc.</li>
  <li>Allows dark launches, which allows you to size appropriately, fix major oversights, take the fear out of major new launches</li>
</ul>

<p>They have a couple hundred “free contingency switches” to turn things off/throttle things down. Gives broad operational control to minimize effects on the site.</p>

<p>Tend to fail forward using these and fix the problem.</p>

<ol>
  <li>Shared metrics</li>
</ol>

<ul>
  <li>You can see mine, I can see yours</li>
  <li>Use ganglia as console</li>
  <li>Devs know where dashboard is, and watch as obsessively as ops</li>
  <li>Includes app-level metrics (which exposes them to Ops)</li>
  <li>(helps drive accountability in both directions in the org—both can see and feel ownership)</li>
  <li>This begins to create opportunity to gracefully collaborate to back off an oversub’d resource/degrade/throttle as needed</li>
  <li>Show last site deploy info on every page/graph; you can corellate a change in the graph</li>
</ul>

<ol>
  <li>IRC and IM bots</li>
</ol>

<ul>
  <li>Heavy IRC users for ongoing dialog between dev/ops, remote/local</li>
  <li>Last.fm wrote a tool to inject events into IRC (monitoring, events, deployments, builds)</li>
  <li>Log it all and put it in a search engine</li>
</ul>

<p>Culture</p>

<p>All the tools in the world won’t help if you have a contentious culture</p>

<ol>
  <li>Respect</li>
</ol>

<ul>
  <li>No stereotypes: not all devs are lazy/cowboys, not all ops are obstructive</li>
  <li>respect their expertise and opinions <strong>and</strong> responsibilities (they influence priorities)</li>
  <li>Don’t just say “no”—it’s like saying “I don’t care about your problem/perspective”</li>
  <li>Best solutions are collaborative. Memcache is an excellent example; written to solve the problem of DB overheat, which impacted both</li>
  <li>Don’t hide things: share your solution even if you think they’ll say no; you deny their expertise and input</li>
</ul>

<p>Talk about the impact of your code push</p>

<ul>
  <li>What metrics change</li>
  <li>what are the risks</li>
  <li>what are the symptoms of somethign going wrong</li>
  <li>what are the contingencies (rollback)</li>
</ul>

<ol>
  <li>Trust</li>
</ol>

<ul>
  <li>When you walk up with all the above on hand, you demonstrate that you care enough about them and the business</li>
  <li>“I don’t want to tell X …” == you’re a cowboy, and “cowboys are losers”</li>
  <li>Have shared playbooks and contingency plans so all understand.</li>
  <li>Provide as many knobs and levers as you can so Ops can tweak to match the env</li>
  <li>Ops: be transparent, give devs insight and access to the systems. Playing telephone around shell commands is dumb.</li>
  <li>It’s hard to help if you can’t directly see</li>
</ul>

<ol>
  <li>Have a healthy attitude around failure—it’s going to happen.</li>
</ol>

<ul>
  <li>Think about how you’ll respond more than you think about how you’ll prevent it</li>
  <li>Would you rather be treated by a GP who deals with heart attacks infrequently or an EMT who handles them weekly?</li>
  <li>Fire drills: when ops and sr engineers are fixing a problem, have others diagnose live in parallel (but make no changes!)</li>
</ul>

<ol>
  <li>Avoiding blame</li>
</ol>

<ul>
  <li>they have a rule of no-finger-pointing; it doesn’t need enforcement, folks step up</li>
  <li>fixing blame wastes a ton of time, why not skip it? Feel guilty afterwards if you must.</li>
  <li>They’ve got a bit of a potlatch culture as people try to assert responsibility in order to fix things.</li>
  <li>Remember that when your code breaks, someone’s going to have to wake up to fix it. Own it and apologize, at least. Otherwise, you’re back to not respecting each other (“Screw you … aren’t you getting paid to do that?”)</li>
</ul>

<p>Ops should provide constructive, continual feedback on how it’s going. Point out interesting things before they’re critical</p>


    <hr>
    <div class="pagination btn-group">
      
        <a class="btn prev" href="/2009/06/liveblog-qa-with-twitters-john-adams.html" title="LiveBlog: Q&A with Twitter's John Adams">&larr; Previous</a>
      
        <a class="btn" href="/archive.html">Archive</a>
      
        <a class="btn next" href="/2009/06/michael-jacksons-obit-via-wordle.html" title="Michael Jackson's Obit via Wordle">Next &rarr;</a>
      
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    
    var disqus_developer = 1;
    var disqus_shortname = 'geekdaily'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
  
  <div class="span4">
    <section>
      <h4>Published</h4>
      <div class="date"><span>23 June 2009</span></div>
      
    </section>
    
      <section>
        <h4>Categories</h4>
        
      </section>
         
             
  </div>
</div>


        </div>
      </div> <!-- /container -->

      <div class="footer-push"></div>
    </div><!--/.page-wrap -->

    <footer>
      <div class="container">
        <p>&copy; 2015 Jim Meyer
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://github.com/dhulihan/hooligan" target="_blank">The Hooligan Theme</a>
        </p>
      </div>
    </footer>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/assets/themes/hooligan/js/jquery.min.js"><\/script>')</script>
    <script src="/assets/themes/hooligan/bootstrap/js/bootstrap.min.js"></script>

    


  </body>
</html>

